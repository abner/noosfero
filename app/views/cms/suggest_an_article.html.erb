<%= error_messages_for 'task' %>

<%= labelled_form_for 'task' do |f| %>

  <%= fields_for :article, @task.article_object do |a| %>
    <%= render :partial => partial_for_class(@task.article_type), :locals => { :f => a } %>
    <%= a.hidden_field(:type) %>
    <%= a.hidden_field(:parent_id) %>
  <% end %>

  <%= labelled_form_field(_('Source'), text_field('task[article]', 'source_name')) %>

  <%= labelled_form_field(_('Source URL'), text_field('task[article]', 'source')) %>

  <% unless logged_in? %>
    <%= required labelled_form_field(_('Your name'), text_field(:task, 'name')) %>
    <%= required labelled_form_field(_('Email'), text_field(:task, 'email')) %>
  <% end %>

  <%= hidden_field_tag('back_to', @back_to) %>

  <%= recaptcha_tags(:display => { :theme => 'clean' }, :ajax => true) unless logged_in? %>

  <% button_bar do %>
    <%= submit_button :save, _('Save') %>
    <%= button :cancel, _('Cancel'), @back_to %>
  <% end %>
<% end %>
